<!DOCTYPE html>

<html>
	<head>
		<link rel="manifest" href="manifest.json" />
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
        <link id="main-css" rel="stylesheet" href="https://dev.drifted.com/wp-content/themes/drifted/game-loader/game-loader.css" onerror="loadFallbackCSS()">
        <script>
            function loadFallbackCSS() {
                var fallback = document.createElement('link');
                fallback.rel = 'stylesheet';
                fallback.href = 'https://www.drifted.com/wp-content/themes/drifted/game-loader/game-loader.css';
                document.head.appendChild(fallback);
            }
        </script>
	</head>
	<body>
		<div id="gameContainer">
            <canvas id="screen"></canvas>
            <div id="ui"></div>
            <div id="transition-layer"></div>
        </div>
        <div id="game-footer">
            <a class="webgl-logo" href="https://www.drifted.com"></a>
            <a class="bug tooltip" href="https://www.drifted.com/contact/?game-referral=https://www.drifted.com/polytrack/"></a>
            <a class="category drifting-games tooltip" href="https://www.drifted.com/car-games/"></a>
            <a class="fullscreen tooltip" href="https://www.drifted.com/polytrack/" style="font-family: Helvetica, Verdana, Arial, sans-serif!important;line-height:unset !important;"></a>
            <a class="title" href="https://www.drifted.com/polytrack/">Polytrack</a>
        </div>
        <!--
                <script type="module" src="main.bundle.js" defer></script>
        -->
        <script>
            const script = document.createElement("script");
            script.type = "module";
            script.src = "main.bundle.js?v=" + new Date().getTime();
            script.defer = true;
            document.body.appendChild(script);
        </script>
        <script>
            console.log("STEP 1");
	    try {
		    console.log("STEP 2");
		    if (window !== window.parent) {
		        console.log("STEP 3");
		
		        const allowedDomain = 'drifted.com';
		        const referrer = document.referrer;
		
		        if (referrer) {
		            const parentHost = new URL(referrer).hostname;
		
		            if (parentHost.endsWith(allowedDomain)) {
		                console.log("STEP 4");
		                document.getElementById('game-footer')?.style.setProperty('display', 'none', 'important');
		            }
		        } else {
		            console.log("No referrer available.");
		        }
		    }
		} catch (e) {
		    console.log("STEP NO", e);
		}
        </script>
        <script defer src="htmlgame.js" type="text/javascript"></script>
	</body>
</html>
